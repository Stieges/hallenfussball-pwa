# Check for config file changes that need CI sync
if git diff --cached --name-only | grep -qE "playwright\.config\.ts|vite\.config\.ts|\.github/workflows/ci\.yml"; then
  echo ""
  echo "âš ï¸  CI-RELEVANTE DATEIEN GEÃ„NDERT!"
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""

  # Show which files changed
  if git diff --cached --name-only | grep -q "playwright.config.ts"; then
    echo "ğŸ“‹ playwright.config.ts geÃ¤ndert"
    echo "   â†’ PrÃ¼fe: Stimmen Projekt-Namen mit ci.yml Ã¼berein?"
    echo "   â†’ PrÃ¼fe: Stimmt der Port mit vite.config.ts Ã¼berein?"
  fi

  if git diff --cached --name-only | grep -q "vite.config.ts"; then
    echo "âš™ï¸  vite.config.ts geÃ¤ndert"
    echo "   â†’ PrÃ¼fe: Stimmt server.port mit playwright.config.ts Ã¼berein?"
  fi

  if git diff --cached --name-only | grep -q "ci.yml"; then
    echo "ğŸ”„ ci.yml geÃ¤ndert"
    echo "   â†’ PrÃ¼fe: Stimmen matrix.project Namen mit playwright.config.ts Ã¼berein?"
  fi

  echo ""
  echo "Aktuelle Ports:"
  echo "   vite.config.ts:       $(grep -E 'port:\s*[0-9]+' vite.config.ts 2>/dev/null | head -1 | grep -oE '[0-9]+')"
  echo "   playwright.config.ts: $(grep -E "PORT.*'[0-9]+'" playwright.config.ts 2>/dev/null | grep -oE '[0-9]+')"
  echo ""
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
fi

# Check for design token changes that need sync verification
if git diff --cached --name-only | grep -qE "src/design-tokens/|src/styles/global\.css"; then
  echo ""
  echo "ğŸ¨ DESIGN TOKEN DATEIEN GEÃ„NDERT"
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
  echo "PrÃ¼fe Token-Synchronisation..."
  if ! npm run tokens:check; then
    echo ""
    echo "âŒ Token Sync Check fehlgeschlagen!"
    echo "   Stelle sicher, dass alle Dateien synchron sind:"
    echo "   - semantic*.ts (gleiche Properties)"
    echo "   - cssVars.ts (alle Properties gemappt)"
    echo "   - global.css (alle CSS Variables in :root und [data-theme])"
    echo ""
    exit 1
  fi
  echo ""
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
fi

npx lint-staged
npm run test -- --run
