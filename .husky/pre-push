# Check for uncommitted CI-relevant changes
UNCOMMITTED_CI_FILES=$(git diff --name-only | grep -E "playwright\.config\.ts|vite\.config\.ts|\.github/workflows/ci\.yml" || true)

if [ -n "$UNCOMMITTED_CI_FILES" ]; then
  echo ""
  echo "ğŸš¨ WARNUNG: Uncommitted CI-relevante Ã„nderungen!"
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
  echo "Folgende Dateien haben lokale Ã„nderungen die NICHT gepusht werden:"
  echo "$UNCOMMITTED_CI_FILES" | while read file; do echo "   - $file"; done
  echo ""
  echo "âš ï¸  CI verwendet den COMMITTED Stand, nicht deine lokalen Ã„nderungen!"
  echo ""
  echo "Optionen:"
  echo "   1. git add <datei> && git commit --amend  (Ã„nderungen inkludieren)"
  echo "   2. git checkout <datei>                   (Lokale Ã„nderungen verwerfen)"
  echo ""
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
  read -p "Trotzdem pushen? (y/N) " -n 1 -r
  echo
  if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "Push abgebrochen."
    exit 1
  fi
fi

npm run lint
npm run build
